@using Microsoft.AspNetCore.Localization
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer

@{
    var requestCulture = Context.Features.Get<IRequestCultureFeature>();
    var currentCulture = requestCulture?.RequestCulture.Culture.Name ?? "vi-VN";
    var returnUrl = Context.Request.Path + Context.Request.QueryString;
}

<div class="language-switcher dropdown">
    <button class="btn btn-outline-light btn-sm dropdown-toggle" type="button" id="languageDropdown" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="bi bi-globe me-1"></i>
        @if (currentCulture == "vi-VN")
        {
            <span>ðŸ‡»ðŸ‡³ Tiáº¿ng Viá»‡t</span>
        }
        else
        {
            <span>ðŸ‡ºðŸ‡¸ English</span>
        }
    </button>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="languageDropdown">
        <li>
            <form asp-controller="Language" asp-action="SetLanguage" method="post" class="dropdown-item-form">
                <input type="hidden" name="culture" value="vi-VN" />
                <input type="hidden" name="returnUrl" value="@returnUrl" />
                <button type="submit" class="dropdown-item @(currentCulture == "vi-VN" ? "active" : "")">
                    <i class="bi bi-check-circle-fill me-2 @(currentCulture == "vi-VN" ? "" : "invisible")"></i>
                    ðŸ‡»ðŸ‡³ Tiáº¿ng Viá»‡t
                </button>
            </form>
        </li>
        <li>
            <form asp-controller="Language" asp-action="SetLanguage" method="post" class="dropdown-item-form">
                <input type="hidden" name="culture" value="en-US" />
                <input type="hidden" name="returnUrl" value="@returnUrl" />
                <button type="submit" class="dropdown-item @(currentCulture == "en-US" ? "active" : "")">
                    <i class="bi bi-check-circle-fill me-2 @(currentCulture == "en-US" ? "" : "invisible")"></i>
                    ðŸ‡ºðŸ‡¸ English
                </button>
            </form>
        </li>
    </ul>
</div>

<style>
    .language-switcher .dropdown-item-form {
        margin: 0;
        padding: 0;
    }
    
    .language-switcher .dropdown-item {
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .language-switcher .dropdown-item:hover {
        background-color: rgba(220, 38, 38, 0.1);
    }
    
    .language-switcher .dropdown-item.active {
        background-color: rgba(220, 38, 38, 0.2);
        font-weight: bold;
    }
</style>
